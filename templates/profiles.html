{% extends "base.html" %}

{% block title %}Profiles - Config Matrix{% endblock %}

{% block content %}

<!-- Modern Sidebar -->
<div class="sidebar">
    <div class="sidebar-main">
        <a href="/dashboard" class="sidebar-item" data-tooltip="Dashboard">
            <i class="bi bi-house-door"></i>
            <span class="sidebar-text">Dashboard</span>
        </a>
        <a href="/computers" class="sidebar-item" data-tooltip="Computers">
            <i class="bi bi-pc-display"></i>
            <span class="sidebar-text">Computers</span>
        </a>
        <a href="/profiles" class="sidebar-item active" data-tooltip="Profiles">
            <i class="bi bi-collection"></i>
            <span class="sidebar-text">Profiles</span>
        </a>
    </div>
    <div class="sidebar-bottom">
        <a href="/logout" class="sidebar-item" data-tooltip="Logout">
            <i class="bi bi-box-arrow-right"></i>
            <span class="sidebar-text">Logout</span>
        </a>
    </div>
</div>

<!-- Main Content Area -->
<div class="main-content">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <!-- Header -->
                <div class="d-flex align-items-center justify-content-between mb-4">
                    <h1 class="mb-0">Profiles</h1>
<button id="add-profile-btn" class="btn btn-success">
                        <i class="bi bi-plus-circle"></i> Add Profile
                    </button>
                </div>
                
                <!-- Search Bar -->
                <div class="mb-4">
                    <div class="input-group">
                        <span class="input-group-text" style="
                            background-color: var(--bg-tertiary);
                            border-color: var(--border-color);
                            color: var(--text-primary);
                        "><i class="bi bi-search"></i></span>
                        <input type="text" id="search-profiles" class="form-control" placeholder="Search profiles by name..." style="
                            background-color: var(--bg-tertiary);
                            border-color: var(--border-color);
                            color: var(--text-primary);
                        ">
                    </div>
                </div>
                
                <!-- Loading spinner -->
                <div id="loading-spinner" class="text-center" style="display: block;">
                    <div class="spinner-border" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <p class="mt-2">Loading profiles...</p>
                </div>
                
                <!-- Error message container -->
                <div id="error-container" style="display: none;">
                    <div class="alert alert-danger" role="alert">
                        <h4 class="alert-heading">Error</h4>
                        <p id="error-message"></p>
                    </div>
                </div>
                

                <!-- Main content container -->
                <div id="profiles-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Available Profiles</h5>
                        </div>
                        <div class="card-body">
                            <div id="profiles-list" class="list-group">
                                <!-- Profiles will be dynamically populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Delete Profile Confirmation Modal -->
<div class="modal fade" id="deleteProfileModal" tabindex="-1" aria-labelledby="deleteProfileModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteProfileModalLabel">
                    <i class="bi bi-exclamation-triangle-fill text-danger me-2"></i>
                    Delete Profile
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-danger" role="alert">
                    <h6 class="alert-heading"><i class="bi bi-exclamation-triangle-fill me-1"></i> Warning!</h6>
                    <p class="mb-2">Deleting this profile will also <strong>permanently delete ALL computers</strong> that are currently using this profile.</p>
                    <p class="mb-0">This action cannot be undone.</p>
                </div>
                
                <div class="mb-3">
                    <strong>Profile to delete:</strong>
                    <div class="p-2 bg-light rounded mt-1" style="background-color: var(--bg-tertiary) !important; border: 1px solid var(--border-color);">
                        <i class="bi bi-collection me-2"></i>
                        <span id="deleteProfileName"></span>
                    </div>
                </div>
                
                <div class="mb-3">
                    <strong>Computers that will be deleted:</strong>
                    <div id="computersToDelete" class="mt-2">
                        <!-- Computers list will be populated here -->
                    </div>
                </div>
                
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="confirmDeleteProfile">
                    <label class="form-check-label" for="confirmDeleteProfile">
                        I understand that this will permanently delete the profile and all associated computers
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="executeDeleteProfile" disabled>
                    <i class="bi bi-trash"></i> Delete Profile
                </button>
            </div>
        </div>
    </div>
</div>

<script src="/static/js/profiles.js"></script>
{% endblock %}

